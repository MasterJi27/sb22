import{R as Fe,O as He,P as Ne,S as Ge,a as ie,V as Ue,b as qe,B as Ve,N as We,A as $e,W as Xe,C as Ye,c as te,d as Ke,e as Je,L as se,f as Qe,U as Ze,T as et}from"./three-dJ1HF1PG.js";import{r as C,j as L}from"./react-DuErVCKP.js";import{c as U,R as tt}from"./react-reconciler-DWNcljWT.js";import{s as be}from"./scheduler-DutjV2e-.js";import{j as nt}from"./react-use-measure-CYMDXrMr.js";import{F as rt,u as ot}from"./its-fine-BkPoueKT.js";import"./react-dom-Dt1d3Zma.js";import{_ as it}from"./@babel-CF3RwP-h.js";function st(e){let n;const i=new Set,o=(p,t)=>{const r=typeof p=="function"?p(n):p;if(r!==n){const l=n;n=t?r:Object.assign({},n,r),i.forEach(c=>c(n,l))}},f=()=>n,v=(p,t=f,r=Object.is)=>{console.warn("[DEPRECATED] Please use `subscribeWithSelector` middleware");let l=t(n);function c(){const u=t(n);if(!r(l,u)){const y=l;p(l=u,y)}}return i.add(c),()=>i.delete(c)},d={setState:o,getState:f,subscribe:(p,t,r)=>t||r?v(p,t,r):(i.add(p),()=>i.delete(p)),destroy:()=>i.clear()};return n=e(o,f,d),d}const at=typeof window>"u"||!window.navigator||/ServerSideRendering|^Deno\//.test(window.navigator.userAgent),ye=at?C.useEffect:C.useLayoutEffect;function ct(e){const n=typeof e=="function"?st(e):e,i=(o=n.getState,f=Object.is)=>{const[,v]=C.useReducer(g=>g+1,0),w=n.getState(),h=C.useRef(w),d=C.useRef(o),p=C.useRef(f),t=C.useRef(!1),r=C.useRef();r.current===void 0&&(r.current=o(w));let l,c=!1;(h.current!==w||d.current!==o||p.current!==f||t.current)&&(l=o(w),c=!f(r.current,l)),ye(()=>{c&&(r.current=l),h.current=w,d.current=o,p.current=f,t.current=!1});const u=C.useRef(w);ye(()=>{const g=()=>{try{const a=n.getState(),m=d.current(a);p.current(r.current,m)||(h.current=a,r.current=m,v())}catch{t.current=!0,v()}},s=n.subscribe(g);return n.getState()!==u.current&&g(),s},[]);const y=c?l:r.current;return C.useDebugValue(y),y};return Object.assign(i,n),i[Symbol.iterator]=function(){console.warn("[useStore, api] = create() is deprecated and will be removed in v4");const o=[i,n];return{next(){const f=o.length<=0;return{value:o.shift(),done:f}}}},i}const ge={},lt=e=>void Object.assign(ge,e);function ut(e,n){function i(t,{args:r=[],attach:l,...c},u){let y=`${t[0].toUpperCase()}${t.slice(1)}`,g;if(t==="primitive"){if(c.object===void 0)throw new Error("R3F: Primitives without 'object' are invalid!");const s=c.object;g=N(s,{type:t,root:u,attach:l,primitive:!0})}else{const s=ge[y];if(!s)throw new Error(`R3F: ${y} is not part of the THREE namespace! Did you forget to extend? See: https://docs.pmnd.rs/react-three-fiber/api/objects#using-3rd-party-objects-declaratively`);if(!Array.isArray(r))throw new Error("R3F: The args prop must be an array!");g=N(new s(...r),{type:t,root:u,attach:l,memoizedProps:{args:r}})}return g.__r3f.attach===void 0&&(g.isBufferGeometry?g.__r3f.attach="geometry":g.isMaterial&&(g.__r3f.attach="material")),y!=="inject"&&le(g,c),g}function o(t,r){let l=!1;if(r){var c,u;(c=r.__r3f)!=null&&c.attach?ce(t,r,r.__r3f.attach):r.isObject3D&&t.isObject3D&&(t.add(r),l=!0),l||(u=t.__r3f)==null||u.objects.push(r),r.__r3f||N(r,{}),r.__r3f.parent=t,me(r),G(r)}}function f(t,r,l){let c=!1;if(r){var u,y;if((u=r.__r3f)!=null&&u.attach)ce(t,r,r.__r3f.attach);else if(r.isObject3D&&t.isObject3D){r.parent=t,r.dispatchEvent({type:"added"}),t.dispatchEvent({type:"childadded",child:r});const g=t.children.filter(a=>a!==r),s=g.indexOf(l);t.children=[...g.slice(0,s),r,...g.slice(s)],c=!0}c||(y=t.__r3f)==null||y.objects.push(r),r.__r3f||N(r,{}),r.__r3f.parent=t,me(r),G(r)}}function v(t,r,l=!1){t&&[...t].forEach(c=>w(r,c,l))}function w(t,r,l){if(r){var c,u,y;if(r.__r3f&&(r.__r3f.parent=null),(c=t.__r3f)!=null&&c.objects&&(t.__r3f.objects=t.__r3f.objects.filter(_=>_!==r)),(u=r.__r3f)!=null&&u.attach)Pe(t,r,r.__r3f.attach);else if(r.isObject3D&&t.isObject3D){var g;t.remove(r),(g=r.__r3f)!=null&&g.root&&gt(ne(r),r)}const a=(y=r.__r3f)==null?void 0:y.primitive,m=!a&&(l===void 0?r.dispose!==null:l);if(!a){var s;v((s=r.__r3f)==null?void 0:s.objects,r,m),v(r.children,r,m)}if(delete r.__r3f,m&&r.dispose&&r.type!=="Scene"){const _=()=>{try{r.dispose()}catch{}};typeof IS_REACT_ACT_ENVIRONMENT>"u"?be.unstable_scheduleCallback(be.unstable_IdlePriority,_):_()}G(t)}}function h(t,r,l,c){var u;const y=(u=t.__r3f)==null?void 0:u.parent;if(!y)return;const g=i(r,l,t.__r3f.root);if(t.children){for(const s of t.children)s.__r3f&&o(g,s);t.children=t.children.filter(s=>!s.__r3f)}t.__r3f.objects.forEach(s=>o(g,s)),t.__r3f.objects=[],t.__r3f.autoRemovedBeforeAppend||w(y,t),g.parent&&(g.__r3f.autoRemovedBeforeAppend=!0),o(y,g),g.raycast&&g.__r3f.eventCount&&ne(g).getState().internal.interaction.push(g),[c,c.alternate].forEach(s=>{s!==null&&(s.stateNode=g,s.ref&&(typeof s.ref=="function"?s.ref(g):s.ref.current=g))})}const d=()=>{};return{reconciler:tt({createInstance:i,removeChild:w,appendChild:o,appendInitialChild:o,insertBefore:f,supportsMutation:!0,isPrimaryRenderer:!1,supportsPersistence:!1,supportsHydration:!1,noTimeout:-1,appendChildToContainer:(t,r)=>{if(!r)return;const l=t.getState().scene;l.__r3f&&(l.__r3f.root=t,o(l,r))},removeChildFromContainer:(t,r)=>{r&&w(t.getState().scene,r)},insertInContainerBefore:(t,r,l)=>{if(!r||!l)return;const c=t.getState().scene;c.__r3f&&f(c,r,l)},getRootHostContext:()=>null,getChildHostContext:t=>t,finalizeInitialChildren(t){var r;return!!((r=t==null?void 0:t.__r3f)!=null?r:{}).handlers},prepareUpdate(t,r,l,c){var u;if(((u=t==null?void 0:t.__r3f)!=null?u:{}).primitive&&c.object&&c.object!==t)return[!0];{const{args:g=[],children:s,...a}=c,{args:m=[],children:_,...S}=l;if(!Array.isArray(g))throw new Error("R3F: the args prop must be an array!");if(g.some((x,k)=>x!==m[k]))return[!0];const E=De(t,a,S,!0);return E.changes.length?[!1,E]:null}},commitUpdate(t,[r,l],c,u,y,g){r?h(t,c,y,g):le(t,l)},commitMount(t,r,l,c){var u;const y=(u=t.__r3f)!=null?u:{};t.raycast&&y.handlers&&y.eventCount&&ne(t).getState().internal.interaction.push(t)},getPublicInstance:t=>t,prepareForCommit:()=>null,preparePortalMount:t=>N(t.getState().scene),resetAfterCommit:()=>{},shouldSetTextContent:()=>!1,clearContainer:()=>!1,hideInstance(t){var r;const{attach:l,parent:c}=(r=t.__r3f)!=null?r:{};l&&c&&Pe(c,t,l),t.isObject3D&&(t.visible=!1),G(t)},unhideInstance(t,r){var l;const{attach:c,parent:u}=(l=t.__r3f)!=null?l:{};c&&u&&ce(u,t,c),(t.isObject3D&&r.visible==null||r.visible)&&(t.visible=!0),G(t)},createTextInstance:d,hideTextInstance:d,unhideTextInstance:d,getCurrentEventPriority:()=>n?n():U.DefaultEventPriority,beforeActiveInstanceBlur:()=>{},afterActiveInstanceBlur:()=>{},detachDeletedInstance:()=>{},now:typeof performance<"u"&&P.fun(performance.now)?performance.now:P.fun(Date.now)?Date.now:()=>0,scheduleTimeout:P.fun(setTimeout)?setTimeout:void 0,cancelTimeout:P.fun(clearTimeout)?clearTimeout:void 0}),applyProps:le}}var _e,Se;const ae=e=>"colorSpace"in e||"outputColorSpace"in e,xe=()=>{var e;return(e=ge.ColorManagement)!=null?e:null},je=e=>e&&e.isOrthographicCamera,ft=e=>e&&e.hasOwnProperty("current"),Y=typeof window<"u"&&((_e=window.document)!=null&&_e.createElement||((Se=window.navigator)==null?void 0:Se.product)==="ReactNative")?C.useLayoutEffect:C.useEffect;function Oe(e){const n=C.useRef(e);return Y(()=>void(n.current=e),[e]),n}function dt({set:e}){return Y(()=>(e(new Promise(()=>null)),()=>e(!1)),[e]),null}class Te extends C.Component{constructor(...n){super(...n),this.state={error:!1}}componentDidCatch(n){this.props.set(n)}render(){return this.state.error?null:this.props.children}}Te.getDerivedStateFromError=()=>({error:!0});const ke="__default",Ce=new Map,pt=e=>e&&!!e.memoized&&!!e.changes;function Ae(e){var n;const i=typeof window<"u"?(n=window.devicePixelRatio)!=null?n:2:1;return Array.isArray(e)?Math.min(Math.max(e[0],i),e[1]):e}const $=e=>{var n;return(n=e.__r3f)==null?void 0:n.root.getState()};function ne(e){let n=e.__r3f.root;for(;n.getState().previousRoot;)n=n.getState().previousRoot;return n}const P={obj:e=>e===Object(e)&&!P.arr(e)&&typeof e!="function",fun:e=>typeof e=="function",str:e=>typeof e=="string",num:e=>typeof e=="number",boo:e=>typeof e=="boolean",und:e=>e===void 0,arr:e=>Array.isArray(e),equ(e,n,{arrays:i="shallow",objects:o="reference",strict:f=!0}={}){if(typeof e!=typeof n||!!e!=!!n)return!1;if(P.str(e)||P.num(e)||P.boo(e))return e===n;const v=P.obj(e);if(v&&o==="reference")return e===n;const w=P.arr(e);if(w&&i==="reference")return e===n;if((w||v)&&e===n)return!0;let h;for(h in e)if(!(h in n))return!1;if(v&&i==="shallow"&&o==="shallow"){for(h in f?n:e)if(!P.equ(e[h],n[h],{strict:f,objects:"reference"}))return!1}else for(h in f?n:e)if(e[h]!==n[h])return!1;if(P.und(h)){if(w&&e.length===0&&n.length===0||v&&Object.keys(e).length===0&&Object.keys(n).length===0)return!0;if(e!==n)return!1}return!0}};function vt(e){e.dispose&&e.type!=="Scene"&&e.dispose();for(const n in e)n.dispose==null||n.dispose(),delete e[n]}function N(e,n){const i=e;return i.__r3f={type:"",root:null,previousAttach:null,memoizedProps:{},eventCount:0,handlers:{},objects:[],parent:null,...n},e}function he(e,n){let i=e;if(n.includes("-")){const o=n.split("-"),f=o.pop();return i=o.reduce((v,w)=>v[w],e),{target:i,key:f}}else return{target:i,key:n}}const Ee=/-\d+$/;function ce(e,n,i){if(P.str(i)){if(Ee.test(i)){const v=i.replace(Ee,""),{target:w,key:h}=he(e,v);Array.isArray(w[h])||(w[h]=[])}const{target:o,key:f}=he(e,i);n.__r3f.previousAttach=o[f],o[f]=n}else n.__r3f.previousAttach=i(e,n)}function Pe(e,n,i){var o,f;if(P.str(i)){const{target:v,key:w}=he(e,i),h=n.__r3f.previousAttach;h===void 0?delete v[w]:v[w]=h}else(o=n.__r3f)==null||o.previousAttach==null||o.previousAttach(e,n);(f=n.__r3f)==null||delete f.previousAttach}function De(e,{children:n,key:i,ref:o,...f},{children:v,key:w,ref:h,...d}={},p=!1){const t=e.__r3f,r=Object.entries(f),l=[];if(p){const u=Object.keys(d);for(let y=0;y<u.length;y++)f.hasOwnProperty(u[y])||r.unshift([u[y],ke+"remove"])}r.forEach(([u,y])=>{var g;if((g=e.__r3f)!=null&&g.primitive&&u==="object"||P.equ(y,d[u]))return;if(/^on(Pointer|Click|DoubleClick|ContextMenu|Wheel)/.test(u))return l.push([u,y,!0,[]]);let s=[];u.includes("-")&&(s=u.split("-")),l.push([u,y,!1,s]);for(const a in f){const m=f[a];a.startsWith(`${u}-`)&&l.push([a,m,!1,a.split("-")])}});const c={...f};return t!=null&&t.memoizedProps&&t!=null&&t.memoizedProps.args&&(c.args=t.memoizedProps.args),t!=null&&t.memoizedProps&&t!=null&&t.memoizedProps.attach&&(c.attach=t.memoizedProps.attach),{memoized:c,changes:l}}function le(e,n){var i;const o=e.__r3f,f=o==null?void 0:o.root,v=f==null||f.getState==null?void 0:f.getState(),{memoized:w,changes:h}=pt(n)?n:De(e,n),d=o==null?void 0:o.eventCount;e.__r3f&&(e.__r3f.memoizedProps=w);for(let l=0;l<h.length;l++){let[c,u,y,g]=h[l];if(ae(e)){const _="srgb",S="srgb-linear";c==="encoding"?(c="colorSpace",u=u===3001?_:S):c==="outputEncoding"&&(c="outputColorSpace",u=u===3001?_:S)}let s=e,a=s[c];if(g.length&&(a=g.reduce((m,_)=>m[_],e),!(a&&a.set))){const[m,..._]=g.reverse();s=_.reverse().reduce((S,E)=>S[E],e),c=m}if(u===ke+"remove")if(s.constructor){let m=Ce.get(s.constructor);m||(m=new s.constructor,Ce.set(s.constructor,m)),u=m[c]}else u=0;if(y&&o)u?o.handlers[c]=u:delete o.handlers[c],o.eventCount=Object.keys(o.handlers).length;else if(a&&a.set&&(a.copy||a instanceof se)){if(Array.isArray(u))a.fromArray?a.fromArray(u):a.set(...u);else if(a.copy&&u&&u.constructor&&a.constructor===u.constructor)a.copy(u);else if(u!==void 0){var p;const m=(p=a)==null?void 0:p.isColor;!m&&a.setScalar?a.setScalar(u):a instanceof se&&u instanceof se?a.mask=u.mask:a.set(u),!xe()&&v&&!v.linear&&m&&a.convertSRGBToLinear()}}else{var t;if(s[c]=u,(t=s[c])!=null&&t.isTexture&&s[c].format===Qe&&s[c].type===Ze&&v){const m=s[c];ae(m)&&ae(v.gl)?m.colorSpace=v.gl.outputColorSpace:m.encoding=v.gl.outputEncoding}}G(e)}if(o&&o.parent&&e.raycast&&d!==o.eventCount){const l=ne(e).getState().internal,c=l.interaction.indexOf(e);c>-1&&l.interaction.splice(c,1),o.eventCount&&l.interaction.push(e)}return!(h.length===1&&h[0][0]==="onUpdate")&&h.length&&(i=e.__r3f)!=null&&i.parent&&me(e),e}function G(e){var n,i;const o=(n=e.__r3f)==null||(i=n.root)==null||i.getState==null?void 0:i.getState();o&&o.internal.frames===0&&o.invalidate()}function me(e){e.onUpdate==null||e.onUpdate(e)}function ht(e,n){e.manual||(je(e)?(e.left=n.width/-2,e.right=n.width/2,e.top=n.height/2,e.bottom=n.height/-2):e.aspect=n.width/n.height,e.updateProjectionMatrix(),e.updateMatrixWorld())}function Z(e){return(e.eventObject||e.object).uuid+"/"+e.index+e.instanceId}function mt(){var e;const n=typeof self<"u"&&self||typeof window<"u"&&window;if(!n)return U.DefaultEventPriority;switch((e=n.event)==null?void 0:e.type){case"click":case"contextmenu":case"dblclick":case"pointercancel":case"pointerdown":case"pointerup":return U.DiscreteEventPriority;case"pointermove":case"pointerout":case"pointerover":case"pointerenter":case"pointerleave":case"wheel":return U.ContinuousEventPriority;default:return U.DefaultEventPriority}}function Le(e,n,i,o){const f=i.get(n);f&&(i.delete(n),i.size===0&&(e.delete(o),f.target.releasePointerCapture(o)))}function gt(e,n){const{internal:i}=e.getState();i.interaction=i.interaction.filter(o=>o!==n),i.initialHits=i.initialHits.filter(o=>o!==n),i.hovered.forEach((o,f)=>{(o.eventObject===n||o.object===n)&&i.hovered.delete(f)}),i.capturedMap.forEach((o,f)=>{Le(i.capturedMap,n,o,f)})}function wt(e){function n(d){const{internal:p}=e.getState(),t=d.offsetX-p.initialClick[0],r=d.offsetY-p.initialClick[1];return Math.round(Math.sqrt(t*t+r*r))}function i(d){return d.filter(p=>["Move","Over","Enter","Out","Leave"].some(t=>{var r;return(r=p.__r3f)==null?void 0:r.handlers["onPointer"+t]}))}function o(d,p){const t=e.getState(),r=new Set,l=[],c=p?p(t.internal.interaction):t.internal.interaction;for(let s=0;s<c.length;s++){const a=$(c[s]);a&&(a.raycaster.camera=void 0)}t.previousRoot||t.events.compute==null||t.events.compute(d,t);function u(s){const a=$(s);if(!a||!a.events.enabled||a.raycaster.camera===null)return[];if(a.raycaster.camera===void 0){var m;a.events.compute==null||a.events.compute(d,a,(m=a.previousRoot)==null?void 0:m.getState()),a.raycaster.camera===void 0&&(a.raycaster.camera=null)}return a.raycaster.camera?a.raycaster.intersectObject(s,!0):[]}let y=c.flatMap(u).sort((s,a)=>{const m=$(s.object),_=$(a.object);return!m||!_?s.distance-a.distance:_.events.priority-m.events.priority||s.distance-a.distance}).filter(s=>{const a=Z(s);return r.has(a)?!1:(r.add(a),!0)});t.events.filter&&(y=t.events.filter(y,t));for(const s of y){let a=s.object;for(;a;){var g;(g=a.__r3f)!=null&&g.eventCount&&l.push({...s,eventObject:a}),a=a.parent}}if("pointerId"in d&&t.internal.capturedMap.has(d.pointerId))for(let s of t.internal.capturedMap.get(d.pointerId).values())r.has(Z(s.intersection))||l.push(s.intersection);return l}function f(d,p,t,r){const l=e.getState();if(d.length){const c={stopped:!1};for(const u of d){const y=$(u.object)||l,{raycaster:g,pointer:s,camera:a,internal:m}=y,_=new te(s.x,s.y,0).unproject(a),S=R=>{var b,M;return(b=(M=m.capturedMap.get(R))==null?void 0:M.has(u.eventObject))!=null?b:!1},E=R=>{const b={intersection:u,target:p.target};m.capturedMap.has(R)?m.capturedMap.get(R).set(u.eventObject,b):m.capturedMap.set(R,new Map([[u.eventObject,b]])),p.target.setPointerCapture(R)},x=R=>{const b=m.capturedMap.get(R);b&&Le(m.capturedMap,u.eventObject,b,R)};let k={};for(let R in p){let b=p[R];typeof b!="function"&&(k[R]=b)}let j={...u,...k,pointer:s,intersections:d,stopped:c.stopped,delta:t,unprojectedPoint:_,ray:g.ray,camera:a,stopPropagation(){const R="pointerId"in p&&m.capturedMap.get(p.pointerId);if((!R||R.has(u.eventObject))&&(j.stopped=c.stopped=!0,m.hovered.size&&Array.from(m.hovered.values()).find(b=>b.eventObject===u.eventObject))){const b=d.slice(0,d.indexOf(u));v([...b,u])}},target:{hasPointerCapture:S,setPointerCapture:E,releasePointerCapture:x},currentTarget:{hasPointerCapture:S,setPointerCapture:E,releasePointerCapture:x},nativeEvent:p};if(r(j),c.stopped===!0)break}}return d}function v(d){const{internal:p}=e.getState();for(const t of p.hovered.values())if(!d.length||!d.find(r=>r.object===t.object&&r.index===t.index&&r.instanceId===t.instanceId)){const l=t.eventObject.__r3f,c=l==null?void 0:l.handlers;if(p.hovered.delete(Z(t)),l!=null&&l.eventCount){const u={...t,intersections:d};c.onPointerOut==null||c.onPointerOut(u),c.onPointerLeave==null||c.onPointerLeave(u)}}}function w(d,p){for(let t=0;t<p.length;t++){const r=p[t].__r3f;r==null||r.handlers.onPointerMissed==null||r.handlers.onPointerMissed(d)}}function h(d){switch(d){case"onPointerLeave":case"onPointerCancel":return()=>v([]);case"onLostPointerCapture":return p=>{const{internal:t}=e.getState();"pointerId"in p&&t.capturedMap.has(p.pointerId)&&requestAnimationFrame(()=>{t.capturedMap.has(p.pointerId)&&(t.capturedMap.delete(p.pointerId),v([]))})}}return function(t){const{onPointerMissed:r,internal:l}=e.getState();l.lastEvent.current=t;const c=d==="onPointerMove",u=d==="onClick"||d==="onContextMenu"||d==="onDoubleClick",g=o(t,c?i:void 0),s=u?n(t):0;d==="onPointerDown"&&(l.initialClick=[t.offsetX,t.offsetY],l.initialHits=g.map(m=>m.eventObject)),u&&!g.length&&s<=2&&(w(t,l.interaction),r&&r(t)),c&&v(g);function a(m){const _=m.eventObject,S=_.__r3f,E=S==null?void 0:S.handlers;if(S!=null&&S.eventCount)if(c){if(E.onPointerOver||E.onPointerEnter||E.onPointerOut||E.onPointerLeave){const x=Z(m),k=l.hovered.get(x);k?k.stopped&&m.stopPropagation():(l.hovered.set(x,m),E.onPointerOver==null||E.onPointerOver(m),E.onPointerEnter==null||E.onPointerEnter(m))}E.onPointerMove==null||E.onPointerMove(m)}else{const x=E[d];x?(!u||l.initialHits.includes(_))&&(w(t,l.interaction.filter(k=>!l.initialHits.includes(k))),x(m)):u&&l.initialHits.includes(_)&&w(t,l.interaction.filter(k=>!l.initialHits.includes(k)))}}f(g,t,s,a)}}return{handlePointer:h}}const ze=e=>!!(e!=null&&e.render),Ie=C.createContext(null),bt=(e,n)=>{const i=ct((h,d)=>{const p=new te,t=new te,r=new te;function l(s=d().camera,a=t,m=d().size){const{width:_,height:S,top:E,left:x}=m,k=_/S;a.isVector3?r.copy(a):r.set(...a);const j=s.getWorldPosition(p).distanceTo(r);if(je(s))return{width:_/s.zoom,height:S/s.zoom,top:E,left:x,factor:1,distance:j,aspect:k};{const R=s.fov*Math.PI/180,b=2*Math.tan(R/2)*j,M=b*(_/S);return{width:M,height:b,top:E,left:x,factor:_/M,distance:j,aspect:k}}}let c;const u=s=>h(a=>({performance:{...a.performance,current:s}})),y=new Ke;return{set:h,get:d,gl:null,camera:null,raycaster:null,events:{priority:1,enabled:!0,connected:!1},xr:null,scene:null,invalidate:(s=1)=>e(d(),s),advance:(s,a)=>n(s,a,d()),legacy:!1,linear:!1,flat:!1,controls:null,clock:new Je,pointer:y,mouse:y,frameloop:"always",onPointerMissed:void 0,performance:{current:1,min:.5,max:1,debounce:200,regress:()=>{const s=d();c&&clearTimeout(c),s.performance.current!==s.performance.min&&u(s.performance.min),c=setTimeout(()=>u(d().performance.max),s.performance.debounce)}},size:{width:0,height:0,top:0,left:0,updateStyle:!1},viewport:{initialDpr:0,dpr:0,width:0,height:0,top:0,left:0,aspect:0,distance:0,factor:0,getCurrentViewport:l},setEvents:s=>h(a=>({...a,events:{...a.events,...s}})),setSize:(s,a,m,_,S)=>{const E=d().camera,x={width:s,height:a,top:_||0,left:S||0,updateStyle:m};h(k=>({size:x,viewport:{...k.viewport,...l(E,t,x)}}))},setDpr:s=>h(a=>{const m=Ae(s);return{viewport:{...a.viewport,dpr:m,initialDpr:a.viewport.initialDpr||m}}}),setFrameloop:(s="always")=>{const a=d().clock;a.stop(),a.elapsedTime=0,s!=="never"&&(a.start(),a.elapsedTime=0),h(()=>({frameloop:s}))},previousRoot:void 0,internal:{active:!1,priority:0,frames:0,lastEvent:C.createRef(),interaction:[],hovered:new Map,subscribers:[],initialClick:[0,0],initialHits:[],capturedMap:new Map,subscribe:(s,a,m)=>{const _=d().internal;return _.priority=_.priority+(a>0?1:0),_.subscribers.push({ref:s,priority:a,store:m}),_.subscribers=_.subscribers.sort((S,E)=>S.priority-E.priority),()=>{const S=d().internal;S!=null&&S.subscribers&&(S.priority=S.priority-(a>0?1:0),S.subscribers=S.subscribers.filter(E=>E.ref!==s))}}}}}),o=i.getState();let f=o.size,v=o.viewport.dpr,w=o.camera;return i.subscribe(()=>{const{camera:h,size:d,viewport:p,gl:t,set:r}=i.getState();if(d.width!==f.width||d.height!==f.height||p.dpr!==v){var l;f=d,v=p.dpr,ht(h,d),t.setPixelRatio(p.dpr);const c=(l=d.updateStyle)!=null?l:typeof HTMLCanvasElement<"u"&&t.domElement instanceof HTMLCanvasElement;t.setSize(d.width,d.height,c)}h!==w&&(w=h,r(c=>({viewport:{...c.viewport,...c.viewport.getCurrentViewport(h)}})))}),i.subscribe(h=>e(h)),i};let ee,yt=new Set,_t=new Set,St=new Set;function ue(e,n){if(e.size)for(const{callback:i}of e.values())i(n)}function X(e,n){switch(e){case"before":return ue(yt,n);case"after":return ue(_t,n);case"tail":return ue(St,n)}}let fe,de;function pe(e,n,i){let o=n.clock.getDelta();for(n.frameloop==="never"&&typeof e=="number"&&(o=e-n.clock.elapsedTime,n.clock.oldTime=n.clock.elapsedTime,n.clock.elapsedTime=e),fe=n.internal.subscribers,ee=0;ee<fe.length;ee++)de=fe[ee],de.ref.current(de.store.getState(),o,i);return!n.internal.priority&&n.gl.render&&n.gl.render(n.scene,n.camera),n.internal.frames=Math.max(0,n.internal.frames-1),n.frameloop==="always"?1:n.internal.frames}function Ct(e){let n=!1,i=!1,o,f,v;function w(p){f=requestAnimationFrame(w),n=!0,o=0,X("before",p),i=!0;for(const r of e.values()){var t;v=r.store.getState(),v.internal.active&&(v.frameloop==="always"||v.internal.frames>0)&&!((t=v.gl.xr)!=null&&t.isPresenting)&&(o+=pe(p,v))}if(i=!1,X("after",p),o===0)return X("tail",p),n=!1,cancelAnimationFrame(f)}function h(p,t=1){var r;if(!p)return e.forEach(l=>h(l.store.getState(),t));(r=p.gl.xr)!=null&&r.isPresenting||!p.internal.active||p.frameloop==="never"||(t>1?p.internal.frames=Math.min(60,p.internal.frames+t):i?p.internal.frames=2:p.internal.frames=1,n||(n=!0,requestAnimationFrame(w)))}function d(p,t=!0,r,l){if(t&&X("before",p),r)pe(p,r,l);else for(const c of e.values())pe(p,c.store.getState());t&&X("after",p)}return{loop:w,invalidate:h,advance:d}}function Et(){const e=C.useContext(Ie);if(!e)throw new Error("R3F: Hooks can only be used within the Canvas component!");return e}function Ft(e,n=0){const i=Et(),o=i.getState().internal.subscribe,f=Oe(e);return Y(()=>o(f,n,i),[n,o,i]),null}const q=new Map,{invalidate:Me,advance:Re}=Ct(q),{reconciler:re,applyProps:F}=ut(q,mt),H={objects:"shallow",strict:!1},Pt=(e,n)=>{const i=typeof e=="function"?e(n):e;return ze(i)?i:new Xe({powerPreference:"high-performance",canvas:n,antialias:!0,alpha:!0,...e})};function Mt(e,n){const i=typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement;if(n){const{width:o,height:f,top:v,left:w,updateStyle:h=i}=n;return{width:o,height:f,top:v,left:w,updateStyle:h}}else if(typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement&&e.parentElement){const{width:o,height:f,top:v,left:w}=e.parentElement.getBoundingClientRect();return{width:o,height:f,top:v,left:w,updateStyle:i}}else if(typeof OffscreenCanvas<"u"&&e instanceof OffscreenCanvas)return{width:e.width,height:e.height,top:0,left:0,updateStyle:i};return{width:0,height:0,top:0,left:0}}function Rt(e){const n=q.get(e),i=n==null?void 0:n.fiber,o=n==null?void 0:n.store;n&&console.warn("R3F.createRoot should only be called once!");const f=typeof reportError=="function"?reportError:console.error,v=o||bt(Me,Re),w=i||re.createContainer(v,U.ConcurrentRoot,null,!1,null,"",f,null);n||q.set(e,{fiber:w,store:v});let h,d=!1,p;return{configure(t={}){let{gl:r,size:l,scene:c,events:u,onCreated:y,shadows:g=!1,linear:s=!1,flat:a=!1,legacy:m=!1,orthographic:_=!1,frameloop:S="always",dpr:E=[1,2],performance:x,raycaster:k,camera:j,onPointerMissed:R}=t,b=v.getState(),M=b.gl;b.gl||b.set({gl:M=Pt(r,e)});let D=b.raycaster;D||b.set({raycaster:D=new Fe});const{params:V,...K}=k||{};if(P.equ(K,D,H)||F(D,{...K}),P.equ(V,D.params,H)||F(D,{params:{...D.params,...V}}),!b.camera||b.camera===p&&!P.equ(p,j,H)){p=j;const A=j instanceof Ye,O=A?j:_?new He(0,0,0,0,.1,1e3):new Ne(75,0,.1,1e3);A||(O.position.z=5,j&&(F(O,j),("aspect"in j||"left"in j||"right"in j||"bottom"in j||"top"in j)&&(O.manual=!0,O.updateProjectionMatrix())),!b.camera&&!(j!=null&&j.rotation)&&O.lookAt(0,0,0)),b.set({camera:O}),D.camera=O}if(!b.scene){let A;c!=null&&c.isScene?A=c:(A=new Ge,c&&F(A,c)),b.set({scene:N(A)})}if(!b.xr){var W;const A=(T,oe)=>{const Q=v.getState();Q.frameloop!=="never"&&Re(T,!0,Q,oe)},O=()=>{const T=v.getState();T.gl.xr.enabled=T.gl.xr.isPresenting,T.gl.xr.setAnimationLoop(T.gl.xr.isPresenting?A:null),T.gl.xr.isPresenting||Me(T)},B={connect(){const T=v.getState().gl;T.xr.addEventListener("sessionstart",O),T.xr.addEventListener("sessionend",O)},disconnect(){const T=v.getState().gl;T.xr.removeEventListener("sessionstart",O),T.xr.removeEventListener("sessionend",O)}};typeof((W=M.xr)==null?void 0:W.addEventListener)=="function"&&B.connect(),b.set({xr:B})}if(M.shadowMap){const A=M.shadowMap.enabled,O=M.shadowMap.type;if(M.shadowMap.enabled=!!g,P.boo(g))M.shadowMap.type=ie;else if(P.str(g)){var J;const B={basic:Ve,percentage:qe,soft:ie,variance:Ue};M.shadowMap.type=(J=B[g])!=null?J:ie}else P.obj(g)&&Object.assign(M.shadowMap,g);(A!==M.shadowMap.enabled||O!==M.shadowMap.type)&&(M.shadowMap.needsUpdate=!0)}const z=xe();z&&("enabled"in z?z.enabled=!m:"legacyMode"in z&&(z.legacyMode=m)),d||F(M,{outputEncoding:s?3e3:3001,toneMapping:a?We:$e}),b.legacy!==m&&b.set(()=>({legacy:m})),b.linear!==s&&b.set(()=>({linear:s})),b.flat!==a&&b.set(()=>({flat:a})),r&&!P.fun(r)&&!ze(r)&&!P.equ(r,M,H)&&F(M,r),u&&!b.events.handlers&&b.set({events:u(v)});const I=Mt(e,l);return P.equ(I,b.size,H)||b.setSize(I.width,I.height,I.updateStyle,I.top,I.left),E&&b.viewport.dpr!==Ae(E)&&b.setDpr(E),b.frameloop!==S&&b.setFrameloop(S),b.onPointerMissed||b.set({onPointerMissed:R}),x&&!P.equ(x,b.performance,H)&&b.set(A=>({performance:{...A.performance,...x}})),h=y,d=!0,this},render(t){return d||this.configure(),re.updateContainer(L.jsx(xt,{store:v,children:t,onCreated:h,rootElement:e}),w,null,()=>{}),v},unmount(){Be(e)}}}function xt({store:e,children:n,onCreated:i,rootElement:o}){return Y(()=>{const f=e.getState();f.set(v=>({internal:{...v.internal,active:!0}})),i&&i(f),e.getState().events.connected||f.events.connect==null||f.events.connect(o)},[]),L.jsx(Ie.Provider,{value:e,children:n})}function Be(e,n){const i=q.get(e),o=i==null?void 0:i.fiber;if(o){const f=i==null?void 0:i.store.getState();f&&(f.internal.active=!1),re.updateContainer(null,o,null,()=>{f&&setTimeout(()=>{try{var v,w,h,d;f.events.disconnect==null||f.events.disconnect(),(v=f.gl)==null||(w=v.renderLists)==null||w.dispose==null||w.dispose(),(h=f.gl)==null||h.forceContextLoss==null||h.forceContextLoss(),(d=f.gl)!=null&&d.xr&&f.xr.disconnect(),vt(f),q.delete(e)}catch{}},500)})}}re.injectIntoDevTools({bundleType:0,rendererPackageName:"@react-three/fiber",version:C.version});const ve={onClick:["click",!1],onContextMenu:["contextmenu",!1],onDoubleClick:["dblclick",!1],onWheel:["wheel",!0],onPointerDown:["pointerdown",!0],onPointerUp:["pointerup",!0],onPointerLeave:["pointerleave",!0],onPointerMove:["pointermove",!0],onPointerCancel:["pointercancel",!0],onLostPointerCapture:["lostpointercapture",!0]};function jt(e){const{handlePointer:n}=wt(e);return{priority:1,enabled:!0,compute(i,o,f){o.pointer.set(i.offsetX/o.size.width*2-1,-(i.offsetY/o.size.height)*2+1),o.raycaster.setFromCamera(o.pointer,o.camera)},connected:void 0,handlers:Object.keys(ve).reduce((i,o)=>({...i,[o]:n(o)}),{}),update:()=>{var i;const{events:o,internal:f}=e.getState();(i=f.lastEvent)!=null&&i.current&&o.handlers&&o.handlers.onPointerMove(f.lastEvent.current)},connect:i=>{var o;const{set:f,events:v}=e.getState();v.disconnect==null||v.disconnect(),f(w=>({events:{...w.events,connected:i}})),Object.entries((o=v.handlers)!=null?o:[]).forEach(([w,h])=>{const[d,p]=ve[w];i.addEventListener(d,h,{passive:p})})},disconnect:()=>{const{set:i,events:o}=e.getState();if(o.connected){var f;Object.entries((f=o.handlers)!=null?f:[]).forEach(([v,w])=>{if(o&&o.connected instanceof HTMLElement){const[h]=ve[v];o.connected.removeEventListener(h,w)}}),i(v=>({events:{...v.events,connected:void 0}}))}}}}const Ot=C.forwardRef(function({children:n,fallback:i,resize:o,style:f,gl:v,events:w=jt,eventSource:h,eventPrefix:d,shadows:p,linear:t,flat:r,legacy:l,orthographic:c,frameloop:u,dpr:y,performance:g,raycaster:s,camera:a,scene:m,onPointerMissed:_,onCreated:S,...E},x){C.useMemo(()=>lt(et),[]);const k=ot(),[j,R]=nt({scroll:!0,debounce:{scroll:50,resize:0},...o}),b=C.useRef(null),M=C.useRef(null);C.useImperativeHandle(x,()=>b.current);const D=Oe(_),[V,K]=C.useState(!1),[W,J]=C.useState(!1);if(V)throw V;if(W)throw W;const z=C.useRef(null);Y(()=>{const A=b.current;R.width>0&&R.height>0&&A&&(z.current||(z.current=Rt(A)),z.current.configure({gl:v,events:w,shadows:p,linear:t,flat:r,legacy:l,orthographic:c,frameloop:u,dpr:y,performance:g,raycaster:s,camera:a,scene:m,size:R,onPointerMissed:(...O)=>D.current==null?void 0:D.current(...O),onCreated:O=>{O.events.connect==null||O.events.connect(h?ft(h)?h.current:h:M.current),d&&O.setEvents({compute:(B,T)=>{const oe=B[d+"X"],Q=B[d+"Y"];T.pointer.set(oe/T.size.width*2-1,-(Q/T.size.height)*2+1),T.raycaster.setFromCamera(T.pointer,T.camera)}}),S==null||S(O)}}),z.current.render(L.jsx(k,{children:L.jsx(Te,{set:J,children:L.jsx(C.Suspense,{fallback:L.jsx(dt,{set:K}),children:n??null})})})))}),C.useEffect(()=>{const A=b.current;if(A)return()=>Be(A)},[]);const I=h?"none":"auto";return L.jsx("div",{ref:M,style:{position:"relative",width:"100%",height:"100%",overflow:"hidden",pointerEvents:I,...f},...E,children:L.jsx("div",{ref:j,style:{width:"100%",height:"100%"},children:L.jsx("canvas",{ref:b,style:{display:"block"},children:i})})})}),Ht=C.forwardRef(function(n,i){return L.jsx(rt,{children:L.jsx(Ot,{...n,ref:i})})});function we(e,n){const i=e+"Geometry";return C.forwardRef(({args:o,children:f,...v},w)=>{const h=C.useRef(null);return C.useImperativeHandle(w,()=>h.current),C.useLayoutEffect(()=>void(n==null?void 0:n(h.current))),C.createElement("mesh",it({ref:h},v),C.createElement(i,{attach:"geometry",args:o}),f)})}const Nt=we("torus"),Gt=we("icosahedron"),Ut=we("octahedron");export{Ht as C,Gt as I,Ut as O,Nt as T,Ft as u};
